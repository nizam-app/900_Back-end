{
	"info": {
		"_postman_id": "fsm-api-collection-2025-v3",
		"name": "FSM System API - Complete Collection",
		"description": "Complete Field Service Management API Collection - Updated Nov 26, 2025 with ALL endpoints including Reviews, Dispatch Center, Time Management, and enhanced features",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Authentication & OTP",
			"item": [
				{
					"name": "Send OTP",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"phone\": \"+8801718981009\",\n  \"type\": \"REGISTRATION\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/otp/send",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"otp",
								"send"
							]
						},
						"description": "Send OTP for phone verification. Types: REGISTRATION, LOGIN, PASSWORD_RESET, VERIFICATION\n\nTESTED & WORKING (Dec 2, 2025)\n\nPhone Format (Bangladesh):\n- +8801718981009 (recommended - with country code)\n- 8801718981009 (works - auto-formatted)\n- 01718981009 (works - auto-converted to 8801718981009)\n\nResponse includes:\n- OTP code (for testing/development)\n- Expiry time (5 minutes)\n- SMS status (sent/failed)\n\nNote: OTP is stored in database and valid for 5 minutes. SMS delivery depends on BulkGate credits."
					}
				},
				{
					"name": "Verify OTP",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"phone\": \"+8801718981009\",\n  \"code\": \"123456\",\n  \"type\": \"REGISTRATION\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/otp/verify",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"otp",
								"verify"
							]
						},
						"description": "Verify OTP code sent to phone number\n\nTESTED & WORKING (Dec 2, 2025)\n\nRequirements:\n- Use the SAME phone format as Send OTP\n- 6-digit code must match exactly\n- Must be verified within 5 minutes\n- Type must match the Send OTP request\n\nSuccess Response:\n- verified: true\n- tempToken: Temporary token for registration (valid 10 minutes)\n- tempTokenExpiry: Token expiration time\n\nUse the tempToken to complete registration with /api/auth/set-password endpoint."
					}
				},
				{
					"name": "Register User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"phone\": \"+8801718981009\",\n  \"password\": \"password123\",\n  \"name\": \"John Doe\",\n  \"role\": \"CUSTOMER\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/register",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"register"
							]
						},
						"description": "Register new user. Roles: CUSTOMER, TECH_FREELANCER, TECH_INTERNAL, DISPATCHER, CALL_CENTER, ADMIN"
					}
				},
				{
					"name": "Login - Admin",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"pm.environment.set(\"adminToken\", jsonData.token);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"phone\": \"1111111111\",\n  \"password\": \"admin123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						}
					}
				},
				{
					"name": "Login - Dispatcher",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"pm.environment.set(\"dispatcherToken\", jsonData.token);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"phone\": \"2222222222\",\n  \"password\": \"dispatcher123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						}
					}
				},
				{
					"name": "Login - Technician (Freelancer)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"pm.environment.set(\"techToken\", jsonData.token);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"phone\": \"5555555555\",\n  \"password\": \"freelancer123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						}
					}
				},
				{
					"name": "Login - Customer",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"pm.environment.set(\"customerToken\", jsonData.token);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"phone\": \"9999999999\",\n  \"password\": \"customer123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						}
					}
				},
				{
					"name": "Logout",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/auth/logout",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"logout"
							]
						},
						"description": "Logout current user and invalidate token"
					}
				},
				{
					"name": "Change Password",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"oldPassword\": \"customer123\",\n  \"newPassword\": \"newPassword456\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/change-password",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"change-password"
							]
						},
						"description": "Change user password (requires old password)"
					}
				},
				{
					"name": "Get My Profile",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Profile has required fields\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('id');",
									"    pm.expect(jsonData).to.have.property('name');",
									"    pm.expect(jsonData).to.have.property('phone');",
									"    pm.expect(jsonData).to.have.property('role');",
									"});",
									"",
									"pm.test(\"Customer profile has statistics\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.role === 'CUSTOMER') {",
									"        pm.expect(jsonData).to.have.property('totalBookings');",
									"        pm.expect(jsonData).to.have.property('totalSpent');",
									"        pm.expect(jsonData).to.have.property('businessHours');",
									"        pm.expect(jsonData.totalBookings).to.be.a('number');",
									"        pm.expect(jsonData.totalSpent).to.be.a('number');",
									"        pm.expect(jsonData.businessHours).to.be.an('object');",
									"        pm.expect(jsonData.businessHours).to.have.property('open');",
									"        pm.expect(jsonData.businessHours).to.have.property('close');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/auth/profile",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"profile"
							]
						},
						"description": "Get current user's profile information with statistics (totalBookings, totalSpent, businessHours for CUSTOMER role)"
					}
				},
				{
					"name": "Update My Profile",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Updated Name\",\n  \"homeAddress\": \"New Address\",\n  \"latitude\": -1.286389,\n  \"longitude\": 36.817223\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/profile",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"profile"
							]
						},
						"description": "Update current user's profile"
					}
				},
				{
					"name": "Update Customer Profile (Call Center)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{callCenterToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Updated Customer Name\",\n  \"homeAddress\": \"Updated Address\",\n  \"latitude\": -1.286389,\n  \"longitude\": 36.817223\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/customer/{{newCustomerId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"customer",
								"{{newCustomerId}}"
							]
						},
						"description": "Call center can update any customer's profile"
					}
				}
			]
		},
		{
			"name": "Service Requests",
			"item": [
				{
					"name": "Search Customer by Phone",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{callCenterToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/sr/search-customer?phone=9999999999",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"sr",
								"search-customer"
							],
							"query": [
								{
									"key": "phone",
									"value": "9999999999"
								}
							]
						},
						"description": "Call center searches for existing customer by phone number before creating SR"
					}
				},
				{
					"name": "Create SR (Guest) with GPS",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"srId\", jsonData.serviceRequest.id);",
									"    pm.environment.set(\"srNumber\", jsonData.serviceRequest.srNumber);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Jane Customer\",\n  \"phone\": \"8888888888\",\n  \"address\": \"456 Oak Street, Downtown\",\n  \"latitude\": -1.292066,\n  \"longitude\": 36.821946,\n  \"categoryId\": 1,\n  \"subserviceId\": 1,\n  \"serviceId\": 1,\n  \"description\": \"AC not cooling properly\",\n  \"paymentType\": \"MOBILE_MONEY\",\n  \"priority\": \"HIGH\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/sr",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"sr"
							]
						},
						"description": "Create service request with GPS coordinates. Returns srId and status explicitly."
					}
				},
				{
					"name": "Create SR (Authenticated Customer)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"srId\", jsonData.serviceRequest.id);",
									"    pm.environment.set(\"srNumber\", jsonData.serviceRequest.srNumber);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"address\": \"789 Service Street, Nairobi\",\n  \"latitude\": -1.286389,\n  \"longitude\": 36.817223,\n  \"categoryId\": 1,\n  \"subserviceId\": 1,\n  \"serviceId\": 1,\n  \"description\": \"Refrigerator not cooling\",\n  \"paymentType\": \"CASH\",\n  \"priority\": \"MEDIUM\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/sr",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"sr"
							]
						},
						"description": "Authenticated customer creates SR. GPS coordinates auto-saved to customer profile."
					}
				},
				{
					"name": "List SRs",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/sr?status=NEW",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"sr"
							],
							"query": [
								{
									"key": "status",
									"value": "NEW"
								}
							]
						},
						"description": "List service requests with optional filters. Customers see only their own, others see all."
					}
				},
				{
					"name": "Get My SRs (Customer)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has serviceRequests array\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('serviceRequests');",
									"    pm.expect(jsonData.serviceRequests).to.be.an('array');",
									"});",
									"",
									"pm.test(\"Each SR has required fields including readableStatus\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.serviceRequests.length > 0) {",
									"        var sr = jsonData.serviceRequests[0];",
									"        pm.expect(sr).to.have.property('id');",
									"        pm.expect(sr).to.have.property('srNumber');",
									"        pm.expect(sr).to.have.property('status');",
									"        pm.expect(sr).to.have.property('readableStatus');",
									"        pm.expect(sr.readableStatus).to.be.a('string');",
									"        pm.expect(sr.readableStatus.length).to.be.above(0);",
									"    }",
									"});",
									"",
									"pm.test(\"All SRs belong to authenticated customer\", function () {",
									"    var jsonData = pm.response.json();",
									"    jsonData.serviceRequests.forEach(function(sr) {",
									"        pm.expect(sr).to.have.property('customerId');",
									"    });",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/srs/my?status=ACTIVE",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"srs",
								"my"
							],
							"query": [
								{
									"key": "status",
									"value": "ACTIVE",
									"description": "Optional: PENDING_APPROVAL, ACTIVE, COMPLETED, CANCELLED, REJECTED"
								}
							]
						},
						"description": "Get only authenticated customer's service requests with readable status. Supports status filtering."
					}
				},
				{
					"name": "Get SR by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/sr/{{srId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"sr",
								"{{srId}}"
							]
						},
						"description": "Get service request details by ID or SR number"
					}
				},
				{
					"name": "Cancel SR",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"reason\": \"Changed my mind\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/sr/{{srId}}/cancel",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"sr",
								"{{srId}}",
								"cancel"
							]
						},
						"description": "Cancel a service request. Customers can cancel their own, staff can cancel any."
					}
				},
				{
					"name": "Rebook Service",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"New SR created with readableStatus\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('sr');",
									"    pm.expect(jsonData.sr).to.have.property('id');",
									"    pm.expect(jsonData.sr).to.have.property('srNumber');",
									"    pm.expect(jsonData.sr).to.have.property('status');",
									"    pm.expect(jsonData.sr).to.have.property('readableStatus');",
									"    pm.expect(jsonData.sr.readableStatus).to.equal('Pending Approval');",
									"});",
									"",
									"pm.test(\"Customization applied\", function () {",
									"    var jsonData = pm.response.json();",
									"    var requestBody = JSON.parse(pm.request.body.raw);",
									"    if (requestBody.preferredDate) {",
									"        pm.expect(jsonData.sr.preferredDate).to.exist;",
									"    }",
									"    if (requestBody.description) {",
									"        pm.expect(jsonData.sr.description).to.equal(requestBody.description);",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"preferredDate\": \"2025-12-05\",\n  \"preferredTime\": \"10:00 AM\",\n  \"description\": \"Rescheduled maintenance\",\n  \"address\": \"Updated location address\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/sr/{{srId}}/rebook",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"sr",
								"{{srId}}",
								"rebook"
							]
						},
						"description": "Rebook a service with customization (new date/time/description/address). Creates new SR based on original."
					}
				},
				{
					"name": "Book Again",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Exact duplicate SR created\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('sr');",
									"    pm.expect(jsonData.sr).to.have.property('id');",
									"    pm.expect(jsonData.sr).to.have.property('srNumber');",
									"    pm.expect(jsonData.sr).to.have.property('status');",
									"    pm.expect(jsonData.sr).to.have.property('readableStatus');",
									"    pm.expect(jsonData.sr.status).to.equal('PENDING_APPROVAL');",
									"    pm.expect(jsonData.sr.readableStatus).to.equal('Pending Approval');",
									"});",
									"",
									"pm.test(\"All service details copied\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.sr).to.have.property('categoryId');",
									"    pm.expect(jsonData.sr).to.have.property('subserviceId');",
									"    pm.expect(jsonData.sr).to.have.property('serviceId');",
									"    pm.expect(jsonData.sr).to.have.property('address');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/sr/{{srId}}/book-again",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"sr",
								"{{srId}}",
								"book-again"
							]
						},
						"description": "Book the same service again with no customization. Creates exact duplicate of original SR."
					}
				}
			]
		},
		{
			"name": "Work Orders",
			"item": [
				{
					"name": "Convert SR to WO",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"woId\", jsonData.woNumber || jsonData.id);",
									"    pm.environment.set(\"woNumber\", jsonData.woNumber);",
									"    console.log('WO Created - ID:', jsonData.id, 'woNumber:', jsonData.woNumber);",
									"} else {",
									"    console.error('Failed to create WO:', pm.response.text());",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"technicianId\": 4,\n  \"scheduledAt\": \"2025-11-24T09:00:00Z\",\n  \"estimatedDuration\": 120,\n  \"notes\": \"Customer prefers morning. Estimated 2 hours.\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/wos/from-sr/{{srId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"from-sr",
								"{{srId}}"
							]
						},
						"description": "Convert SR to WO with estimatedDuration (minutes). GPS coordinates automatically copied from SR."
					}
				},
				{
					"name": "Get All Work Orders",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/wos?status=ASSIGNED",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos"
							],
							"query": [
								{
									"key": "status",
									"value": "ASSIGNED",
									"description": "Filter by work order status"
								},
								{
									"key": "technicianId",
									"value": "",
									"disabled": true,
									"description": "Filter by technician ID (for my tasks)"
								},
								{
									"key": "page",
									"value": "1",
									"disabled": true,
									"description": "Page number"
								},
								{
									"key": "limit",
									"value": "10",
									"disabled": true,
									"description": "Results per page"
								}
							]
						},
						"description": "Get all work orders with filtering options.\n\n**2.1 WHERE I GET START, ACTIVE, THIS MONTH (Dashboard Stats):**\n\n• **Ready to Start (2)**: `GET /api/wos?technicianId={yourId}&status=ASSIGNED`\n  - Jobs assigned to you, waiting for acceptance\n  - Shows in \"Ready to Start\" section with count\n\n• **Active Now (1)**: `GET /api/wos?technicianId={yourId}&status=ACCEPTED` or `status=IN_PROGRESS`\n  - Jobs you accepted or currently working on\n  - Shows in \"Active\" tab with count\n\n• **This Month (28)**: `GET /api/wos?technicianId={yourId}&status=COMPLETED`\n  - Jobs you finished this month\n  - Shows in \"Completed\" tab with count\n  - Also from: `/api/commissions/dashboard` → totalJobsCompleted\n\n**2.2 TASKS ASSIGNED TO FREELANCER TECHNICIAN:**\n\nEach task card displays:\n• Customer: Name + Phone (Michael Johnson +1 234 567 8900)\n• Location: Address with GPS (123 Main St, Apt 4B)\n• Scheduled: Date and time (Today at 2:00 PM)\n• Commission: Your earnings ($18.00 from $120 job = 15%)\n• Payment note: \"Payment follows completion verification\"\n• Action buttons: Complete Job, Close\n\n**API Response Structure:**\n```json\n{\n  \"workOrders\": [\n    {\n      \"id\": 4,\n      \"woNumber\": \"WO-1234567890\",\n      \"status\": \"IN_PROGRESS\",\n      \"customer\": {\n        \"name\": \"Michael Johnson\",\n        \"phone\": \"+1 234 567 8900\"\n      },\n      \"address\": \"123 Main St, Apt 4B\",\n      \"latitude\": 23.8103,\n      \"longitude\": 90.4125,\n      \"scheduledAt\": \"2025-12-03T14:00:00Z\",\n      \"commissions\": [\n        {\n          \"type\": \"COMMISSION\",\n          \"amount\": 18.00,\n          \"status\": \"PENDING\"\n        }\n      ],\n      \"payments\": [\n        {\n          \"amount\": 120,\n          \"status\": \"PENDING_VERIFICATION\"\n        }\n      ]\n    }\n  ]\n}\n```\n\n**Query Parameters:**\n• status: Filter by status (UNASSIGNED, ASSIGNED, ACCEPTED, IN_PROGRESS, COMPLETED, CANCELLED)\n• technicianId: Filter by technician ID (for freelancer to see their own tasks)\n• customerId: Filter by customer ID\n• priority: Filter by priority (LOW, MEDIUM, HIGH, URGENT)\n• page: Page number (default: 1)\n• limit: Results per page (default: 10)\n\n**For Freelancer Technician Dashboard:**\n\n1. **Active Tasks (Ready to Start + In Progress):**\n   - Ready to Start: `GET /api/wos?technicianId={id}&status=ASSIGNED`\n   - Active Now: `GET /api/wos?technicianId={id}&status=ACCEPTED`\n   - In Progress: `GET /api/wos?technicianId={id}&status=IN_PROGRESS`\n\n2. **Completed Tasks This Month:**\n   - `GET /api/wos?technicianId={id}&status=COMPLETED`\n\n3. **Task Counts:**\n   • Ready to Start: Count results with status=ASSIGNED\n   • Active Now: Count results with status=ACCEPTED or IN_PROGRESS\n   • This Month: Count results with status=COMPLETED (filter by date range)\n\nResponse includes full work order details with customer, technician, category info, payment and commission data, service request reference, and GPS coordinates for location."
					}
				},
				{
					"name": "Get WO by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}"
							]
						}
					}
				},
				{
					"name": "Assign Technician to WO",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"technicianId\": 6\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}/assign",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}",
								"assign"
							]
						}
					}
				},
				{
					"name": "Accept WO (Technician)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"ACCEPT\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}/respond",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}",
								"respond"
							]
						},
						"description": "Technician accepts assigned work order (Ready to Start). Action: ACCEPT. This moves the work order from ASSIGNED to ACCEPTED status, indicating the technician has confirmed they will complete the job. Next Steps: 1) Review job details 2) Travel to customer location 3) Click Start Job button with GPS check-in. UI Button: View Details then Accept Job"
					}
				},
				{
					"name": "Decline WO (Technician)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"DECLINE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}/respond",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}",
								"respond"
							]
						},
						"description": "Technician declines assigned work order. Action: DECLINE, Required: declineReason. This returns the work order to UNASSIGNED status so dispatcher can reassign to another technician. Common decline reasons: Unable to reach location, Lack required skills or tools, Schedule conflict, Emergency situation"
					}
				},
				{
					"name": "Start Job (GPS Check-in)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"lat\": 23.8103,\n  \"lng\": 90.4125\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}/start",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}",
								"start"
							]
						},
						"description": "Start work order with GPS check-in verification. Required: lat (latitude), lng (longitude). This changes status from ACCEPTED to IN_PROGRESS and records start time, GPS coordinates for location verification, and technician arrival confirmation. UI Flow: 1) Technician clicks Continue or Start Job button 2) App captures GPS location 3) Verifies technician is at job site 4) Status updates to In Progress. Note: GPS verification ensures service quality and prevents fraud."
					}
				},
				{
					"name": "Complete Job",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "completionNotes",
									"value": "AC fixed, cleaned filters, refilled gas",
									"type": "text"
								},
								{
									"key": "materialsUsed",
									"value": "[{\"item\":\"Air Filter\",\"qty\":1,\"cost\":50},{\"item\":\"Refrigerant Gas\",\"qty\":2,\"cost\":200}]",
									"type": "text"
								},
								{
									"key": "photos",
									"type": "file",
									"src": []
								},
								{
									"key": "photos",
									"type": "file",
									"src": []
								}
							]
						},
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}/complete",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}",
								"complete"
							]
						},
						"description": "Complete work order with photos and notes.\n\n**UI Flow (Complete Job Modal):**\n\n1. **Work Photos (Required):**\n   - Tap to upload photos\n   - At least 1 photo required\n   - Maximum 5 photos allowed (10MB each)\n   - Formats: JPEG, PNG, PDF\n   - Shows before/after work evidence\n\n2. **Work Notes (Optional):**\n   - Add notes about work completed\n   - Parts used details\n   - Recommendations for customer\n   - Any issues encountered\n\n3. **Commission Calculation Display:**\n   - Job Payment: $120\n   - Commission Rate: 15%\n   - You Earn: $18.00\n   - Payment processed after job completion verification\n\n**Request Format:**\n- Content-Type: multipart/form-data\n- Authorization: Bearer {{techToken}}\n\n**Form Fields:**\n• photos (required): File uploads (min 1, max 5)\n• completionNotes (optional): String - Work description\n• materialsUsed (optional): JSON array - [{\"item\":\"Air Filter\",\"qty\":1,\"cost\":50}]\n\n**Status Flow:**\nIN_PROGRESS → COMPLETED\n\n**What Happens After:**\n1. Work order status changes to COMPLETED\n2. Photos uploaded to server\n3. Admin receives notification to verify payment\n4. After admin approves payment proof:\n   - Commission calculated (15% of job payment)\n   - Commission added to your wallet as EARNED\n   - Available for payout request\n\n**Commission Calculation Example:**\n```\nJob Payment: $120\nCommission Rate: 15% (from your profile)\nYour Earnings: $120 × 0.15 = $18.00\nStatus: EARNED (available in wallet)\n```\n\n**UI Actions:**\n• Continue button → Opens complete job modal\n• Complete Job button → Submits photos and notes\n• Cancel → Returns to job details\n\n**Status:** ✅ PRODUCTION READY"
					}
				},
				{
					"name": "Cancel WO",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"reason\": \"Customer cancelled request\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}/cancel",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}",
								"cancel"
							]
						},
						"description": "Cancel work order (Admin/Dispatcher only)"
					}
				},
				{
					"name": "Get Time Remaining",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}/time-remaining",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}",
								"time-remaining"
							]
						},
						"description": "Get remaining time before work order expires (status auto-changes after deadline)"
					}
				},
				{
					"name": "Get Active Deadlines (Admin)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/wos/admin/active-deadlines",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"admin",
								"active-deadlines"
							]
						},
						"description": "View all active work order deadlines with time remaining"
					}
				},
				{
					"name": "Cleanup Expired WOs (Admin)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/wos/admin/cleanup-expired",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"admin",
								"cleanup-expired"
							]
						},
						"description": "Manually trigger cleanup of expired work orders (auto-runs every 5 minutes)"
					}
				},
				{
					"name": "Reassign WO",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"technicianId\": 5,\n  \"reason\": \"Previous technician unavailable\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}/reassign",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}",
								"reassign"
							]
						},
						"description": "Reassign work order to a different technician (Admin/Dispatcher only).\n\nUse Cases:\n• Original technician unavailable\n• Better skilled technician needed\n• Load balancing between technicians\n• Technician declined the job\n\nRequest Body:\n• technicianId (required): New technician ID (must be active/unblocked)\n• reason (optional): Reason for reassignment\n\nIMPORTANT: Ensure the technician ID is active and not blocked. Use Get All Technicians endpoint to find available technicians.\n\nNote: This changes the assigned technician. For rescheduling dates/times, you need to:\n1. Cancel the current WO\n2. Create a new WO from the SR with updated schedule\n\nOr use the SR Rebook endpoint before WO creation."
					}
				},
				{
					"name": "Reschedule WO",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"scheduledDate\": \"2025-12-05\",\n  \"scheduledTime\": \"14:00\",\n  \"estimatedDuration\": 2,\n  \"notes\": \"Rescheduled at customer request\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/wos/{{woId}}/reschedule",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"wos",
								"{{woId}}",
								"reschedule"
							]
						},
						"description": "Reschedule work order to a different date and time (Admin/Dispatcher only).\n\nUse Cases:\n• Customer requests different date/time\n• Technician availability changed\n• Weather or emergency delays\n• Optimizing technician schedule\n\nRequest Body:\n• scheduledDate (required): Date in YYYY-MM-DD format\n• scheduledTime (required): Time in HH:MM format (24-hour)\n• estimatedDuration (optional): Duration in hours (will be converted to minutes)\n• notes (optional): Reason for rescheduling\n\nRestrictions:\n• Cannot reschedule COMPLETED or CANCELLED work orders\n• New date/time must be in the future\n• Technician and customer will be notified"
					}
				}
			]
		},
		{
			"name": "Payments",
			"item": [
				{
					"name": "Upload Payment Proof (Technician)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"pm.environment.set(\"paymentId\", jsonData.id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "woId",
									"value": "{{woId}}",
									"type": "text",
									"description": "Work Order ID"
								},
								{
									"key": "amount",
									"value": "5000",
									"type": "text",
									"description": "Payment amount received from customer"
								},
								{
									"key": "method",
									"value": "MOBILE_MONEY",
									"type": "text",
									"description": "MOBILE_MONEY or CASH"
								},
								{
									"key": "transactionRef",
									"value": "MPESA-ABC123456",
									"type": "text",
									"description": "M-Pesa/Mobile Money transaction reference"
								},
								{
									"key": "proof",
									"type": "file",
									"src": [],
									"description": "Payment screenshot (M-Pesa) or bank deposit slip (Cash)"
								}
							]
						},
						"url": {
							"raw": "{{baseUrl}}/api/payments",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payments"
							]
						},
						"description": "Technician uploads payment proof after completing job:\n- Mobile Money: Screenshot of M-Pesa/mobile money transaction\n- Cash: Bank deposit slip or receipt showing cash deposited to company account"
					}
				},
				{
					"name": "Get All Payments",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/payments?status=PENDING_VERIFICATION",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payments"
							],
							"query": [
								{
									"key": "status",
									"value": "PENDING_VERIFICATION"
								}
							]
						},
						"description": "Get all payments with optional status filter (Admin/Dispatcher only)"
					}
				},
				{
					"name": "Get Payment Stats",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/payments/stats/overview",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payments",
								"stats",
								"overview"
							]
						},
						"description": "Get payment statistics overview including totals by status and method"
					}
				},
				{
					"name": "Get Payment by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/payments/{{paymentId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payments",
								"{{paymentId}}"
							]
						},
						"description": "Get payment details by ID (accessible by Admin, Dispatcher, and Technicians)"
					}
				},
				{
					"name": "Verify Payment (Approve)",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"APPROVE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/payments/{{paymentId}}/verify",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payments",
								"{{paymentId}}",
								"verify"
							]
						},
						"description": "Approve payment proof and trigger commission calculation (Admin/Dispatcher only)"
					}
				},
				{
					"name": "Reject Payment",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"REJECT\",\n  \"reason\": \"Unclear screenshot\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/payments/{{paymentId}}/verify",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"payments",
								"{{paymentId}}",
								"verify"
							]
						},
						"description": "Reject payment proof with reason, work order returns to COMPLETED status (Admin/Dispatcher only)"
					}
				}
			]
		},
		{
			"name": "Commissions & Payouts",
			"item": [
				{
					"name": "Get My Wallet Balance",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/commissions/wallet",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"commissions",
								"wallet"
							]
						},
						"description": "Get technician/freelancer wallet balance and recent transactions.\n\nResponse includes:\n• balance: Current available balance (always >= 0)\n• actualBalance: Real balance (may be negative if adjustments needed)\n• recentTransactions: Last 10 wallet transactions\n• warning: Alert if balance requires adjustment\n\nWallet is automatically created when technician completes their first paid work order."
					}
				},
				{
					"name": "Get My Commissions",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/commissions/my-commissions?status=EARNED",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"commissions",
								"my-commissions"
							],
							"query": [
								{
									"key": "status",
									"value": "EARNED"
								}
							]
						},
						"description": "✅ ENHANCED - Commission Transaction History\n\n**UI: Recent Transactions Section**\n\nDisplays recent commission earnings with \"View All\" link:\n```\nRecent Transactions        View All\n\nHVAC Maintenance           $95\nMichael Johnson\nToday, 2:00 PM\n\nPlumbing Repair            $75\nRobert Brown\nNov 3, 2025\n\nHVAC Installation         $200\nEmily Davis\nNov 2, 2025\n\nElectrical Repair          $55\nJames Wilson\nNov 1, 2025\n```\n\n**API Response Structure:**\n```json\n[\n  {\n    \"id\": 1,\n    \"type\": \"COMMISSION\",\n    \"amount\": 95,\n    \"status\": \"EARNED\",\n    \"technicianId\": 5,\n    \"workOrderId\": 4,\n    \"workOrder\": {\n      \"woNumber\": \"WO-1234567890\",\n      \"completedAt\": \"2025-12-03T14:00:00Z\",\n      \"customer\": {\n        \"name\": \"Michael Johnson\"\n      },\n      \"category\": {\n        \"name\": \"HVAC Maintenance\"\n      }\n    },\n    \"createdAt\": \"2025-12-03T14:00:00Z\"\n  }\n]\n```\n\n**Query Parameters:**\n• status: Filter by EARNED, PAID, PENDING (default: all)\n• startDate: Filter from date YYYY-MM-DD (e.g., 2025-11-01)\n• endDate: Filter to date YYYY-MM-DD (e.g., 2025-12-03)\n• limit: Number of results (use ?limit=4 for \"Recent\")\n\n**For Recent Transactions (Last 4):**\n`GET /api/commissions/my-commissions?status=EARNED&limit=4`\n\n**For View All Transactions:**\n`GET /api/commissions/my-commissions?status=EARNED`\n\n**Display Format:**\n1. **Job Type:** workOrder.category.name (\"HVAC Maintenance\")\n2. **Customer:** workOrder.customer.name (\"Michael Johnson\")\n3. **Date:** Format completedAt as \"Today, 2:00 PM\" or \"Nov 3, 2025\"\n4. **Amount:** Commission earned in green ($95)\n\n**Commission Calculation:**\n```\nJob Payment: $633 (from work order)\nCommission Rate: 15% (from profile)\nYour Earnings: $633 × 0.15 = $95\n```\n\n**Response Fields:**\n• amount: Commission earned per job\n• status: EARNED (available), PAID (withdrawn), PENDING (processing)\n• workOrder: Job details with customer, category, completion date\n• createdAt: When commission was recorded\n\n**Status:** ✅ PRODUCTION READY"
					}
				},
				{
					"name": "Technician Dashboard",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/commissions/dashboard",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"commissions",
								"dashboard"
							]
						},
						"description": "✅ ENHANCED - Technician Financial Dashboard\n\n**UI: This Month Breakdown Section**\n\nDisplays monthly performance summary:\n```\nJobs Completed\n28 jobs                    $6,450\n\nCommission\nEarnings rate              $320\n\nTotal                      $6,770\n```\n\n**API Response Structure:**\n```json\n{\n  \"walletBalance\": 6770,\n  \"totalEarned\": 320,\n  \"totalPaid\": 0,\n  \"pendingPayout\": 320,\n  \"totalAllTimeEarnings\": 320,\n  \"totalJobsCompleted\": 28\n}\n```\n\n**Field Mapping:**\n• **Jobs Completed:** totalJobsCompleted (28 jobs)\n• **Jobs Value:** Sum of all completed job payments ($6,450)\n  - Get from: `GET /api/wos?technicianId={id}&status=COMPLETED`\n  - Sum: payments[].amount\n\n• **Commission Earnings:** totalEarned ($320)\n  - Your earnings at commission rate (typically 15%)\n  - Status: EARNED (available in wallet)\n\n• **Total:** walletBalance ($6,770)\n  - Jobs Value + Commission = $6,450 + $320 = $6,770\n  - Available for payout request\n\n**Response Fields:**\n• walletBalance: Current available balance\n• totalEarned: Total earned commissions (EARNED status)\n• totalPaid: Already withdrawn amount (PAID status)\n• pendingPayout: Same as totalEarned (available for withdrawal)\n• totalAllTimeEarnings: Lifetime total (all statuses)\n• totalJobsCompleted: Count of COMPLETED work orders\n\n**Usage:**\n1. Display \"28 jobs\" from totalJobsCompleted\n2. Calculate jobs value by summing work order payments\n3. Display \"$320\" from totalEarned (commission earnings)\n4. Display \"$6,770\" from walletBalance (total available)\n\n**Note:** Commission rate is stored in technicianProfile.commissionRate (default 15%)\n\n**Status:** ✅ PRODUCTION READY"
					}
				},
				{
					"name": "Request Payout",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"pm.environment.set(\"payoutRequestId\", jsonData.id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"amount\": 100,\n  \"reason\": \"Need funds for expenses\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/commissions/payout-request",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"commissions",
								"payout-request"
							]
						}
					}
				},
				{
					"name": "Get All Payout Requests (Admin)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/commissions/payout-requests?status=PENDING",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"commissions",
								"payout-requests"
							],
							"query": [
								{
									"key": "status",
									"value": "PENDING"
								}
							]
						}
					}
				},
				{
					"name": "Approve Payout Request",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"APPROVE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/commissions/payout-requests/{{payoutRequestId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"commissions",
								"payout-requests",
								"{{payoutRequestId}}"
							]
						}
					}
				},
				{
					"name": "Reject Payout Request",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"action\": \"REJECT\",\n  \"reason\": \"Insufficient earned balance\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/commissions/payout-requests/{{payoutRequestId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"commissions",
								"payout-requests",
								"{{payoutRequestId}}"
							]
						}
					}
				},
				{
					"name": "Run Weekly Payout (Admin)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/commissions/payouts/weekly",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"commissions",
								"payouts",
								"weekly"
							]
						}
					}
				}
			]
		},
		{
			"name": "Categories & Services",
			"item": [
				{
					"name": "List All Categories",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/categories",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories"
							]
						},
						"description": "Get all categories with subservices and services (public endpoint)"
					}
				},
				{
					"name": "Create Category",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Cleaning Services\",\n  \"description\": \"Professional cleaning services\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/categories",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories"
							]
						},
						"description": "Create new category (Admin only)"
					}
				},
				{
					"name": "Update Category",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Updated Category Name\",\n  \"description\": \"Updated description\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/categories/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"1"
							]
						},
						"description": "Update category details"
					}
				},
				{
					"name": "Delete Category",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/categories/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"1"
							]
						},
						"description": "Delete category (Admin only)"
					}
				},
				{
					"name": "Activate Category",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/categories/1/activate",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"1",
								"activate"
							]
						},
						"description": "Activate category to make it visible to customers"
					}
				},
				{
					"name": "Deactivate Category",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/categories/1/deactivate",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"1",
								"deactivate"
							]
						},
						"description": "Deactivate category to hide from customers"
					}
				},
				{
					"name": "Create Subservice",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"categoryId\": 1,\n  \"name\": \"AC Maintenance\",\n  \"description\": \"Regular AC maintenance\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/categories/subservices",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"subservices"
							]
						},
						"description": "Create new subservice under a category"
					}
				},
				{
					"name": "Update Subservice",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Updated Subservice\",\n  \"description\": \"Updated description\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/categories/subservices/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"subservices",
								"1"
							]
						},
						"description": "Update subservice details"
					}
				},
				{
					"name": "Delete Subservice",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/categories/subservices/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"subservices",
								"1"
							]
						},
						"description": "Delete subservice"
					}
				},
				{
					"name": "Create Service",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"categoryId\": 1,\n  \"subserviceId\": 1,\n  \"name\": \"AC Gas Refill\",\n  \"description\": \"Refrigerant gas refilling\",\n  \"baseRate\": 300\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/categories/services",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"services"
							]
						},
						"description": "Create new service under a subservice"
					}
				},
				{
					"name": "Update Service",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Updated Service\",\n  \"description\": \"Updated description\",\n  \"baseRate\": 350\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/categories/services/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"services",
								"1"
							]
						},
						"description": "Update service details and pricing"
					}
				},
				{
					"name": "Delete Service",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/categories/services/1",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"categories",
								"services",
								"1"
							]
						},
						"description": "Delete service"
					}
				}
			]
		},
		{
			"name": "Admin Dashboard",
			"item": [
				{
					"name": "Get Dashboard Stats",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/dashboard",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"dashboard"
							]
						},
						"description": "Get comprehensive dashboard statistics including work orders, users, payments, and commissions"
					}
				},
				{
					"name": "List All Users",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/users?role=TECH_FREELANCER",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users"
							],
							"query": [
								{
									"key": "role",
									"value": "TECH_FREELANCER"
								}
							]
						},
						"description": "List all users with optional role filter"
					}
				},
				{
					"name": "Create User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"phone\": \"6666666666\",\n  \"password\": \"tech456\",\n  \"name\": \"New Technician\",\n  \"role\": \"TECH_FREELANCER\",\n  \"technicianProfile\": {\n    \"commissionRate\": 0.2,\n    \"bonusRate\": 0.05\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/users",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users"
							]
						},
						"description": "Create new user with optional technician profile"
					}
				},
				{
					"name": "Update User",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Updated Name\",\n  \"phone\": \"7777777777\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/6",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users",
								"6"
							]
						},
						"description": "Update user basic information"
					}
				},
				{
					"name": "Block Technician",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"isBlocked\": true,\n  \"blockedReason\": \"Multiple customer complaints\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/6/block",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users",
								"6",
								"block"
							]
						},
						"description": "Block technician from accepting new work orders"
					}
				},
				{
					"name": "Unblock Technician",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"isBlocked\": false\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/6/block",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users",
								"6",
								"block"
							]
						},
						"description": "Unblock technician to allow accepting work orders"
					}
				},
				{
					"name": "Update Technician Profile",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"commissionRate\": 0.25,\n  \"bonusRate\": 0.07,\n  \"status\": \"ACTIVE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/admin/users/6/profile",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"users",
								"6",
								"profile"
							]
						},
						"description": "Update technician profile including commission rates and status"
					}
				},
				{
					"name": "Get Technician Locations (Map View)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/technician-locations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"technician-locations"
							]
						},
						"description": "Get all technician locations for map visualization"
					}
				},
				{
					"name": "Get Top 5 Technicians",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/top-5-technicians",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"top-5-technicians"
							]
						},
						"description": "Get top 5 performing technicians by completed jobs and earnings"
					}
				},
				{
					"name": "Get In-Progress Work Orders",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/work-orders/in-progress",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"work-orders",
								"in-progress"
							]
						},
						"description": "Get all work orders currently in progress"
					}
				},
				{
					"name": "Get Technician Status Summary",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/technicians/status-summary",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"technicians",
								"status-summary"
							]
						},
						"description": "Get summary of technician statuses (online, offline, busy)"
					}
				},
				{
					"name": "Get Technician Stats",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/technicians/stats",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"technicians",
								"stats"
							]
						},
						"description": "Get detailed statistics for all technicians"
					}
				},
				{
					"name": "Get Work Order Audit Trail",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/work-orders/{{woId}}/audit-trail",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"work-orders",
								"{{woId}}",
								"audit-trail"
							]
						},
						"description": "Get complete audit trail for a work order"
					}
				},
				{
					"name": "Get Audit Logs",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/audit-logs?action=PAYMENT_VERIFIED",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"audit-logs"
							],
							"query": [
								{
									"key": "action",
									"value": "PAYMENT_VERIFIED"
								}
							]
						},
						"description": "Get system-wide audit logs with optional action filter"
					}
				},
				{
					"name": "Create Weekly Payout Batch",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/admin/payouts/batch",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"admin",
								"payouts",
								"batch"
							]
						},
						"description": "Create weekly payout batch for all technicians with earned commissions"
					}
				}
			]
		},
		{
			"name": "Reports",
			"item": [
				{
					"name": "Work Order Report",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/reports/work-orders?startDate=2025-11-01&endDate=2025-11-30&status=PAID_VERIFIED",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"reports",
								"work-orders"
							],
							"query": [
								{
									"key": "startDate",
									"value": "2025-11-01"
								},
								{
									"key": "endDate",
									"value": "2025-11-30"
								},
								{
									"key": "status",
									"value": "PAID_VERIFIED"
								}
							]
						}
					}
				},
				{
					"name": "Commission Report",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/reports/commissions?startDate=2025-11-01&status=PAID",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"reports",
								"commissions"
							],
							"query": [
								{
									"key": "startDate",
									"value": "2025-11-01"
								},
								{
									"key": "status",
									"value": "PAID"
								}
							]
						}
					}
				},
				{
					"name": "Payment Report",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/reports/payments?method=MOBILE_MONEY",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"reports",
								"payments"
							],
							"query": [
								{
									"key": "method",
									"value": "MOBILE_MONEY"
								}
							]
						}
					}
				},
				{
					"name": "Technician Performance",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/reports/technician-performance?startDate=2025-11-01",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"reports",
								"technician-performance"
							],
							"query": [
								{
									"key": "startDate",
									"value": "2025-11-01"
								}
							]
						}
					}
				},
				{
					"name": "Financial Report",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{adminToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/reports/financial?startDate=2025-11-01&endDate=2025-11-30",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"reports",
								"financial"
							],
							"query": [
								{
									"key": "startDate",
									"value": "2025-11-01"
								},
								{
									"key": "endDate",
									"value": "2025-11-30"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "Notifications",
			"item": [
				{
					"name": "Get My Notifications",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response is an array\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.be.an('array');",
									"});",
									"",
									"pm.test(\"Each notification has required fields\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.length > 0) {",
									"        var notification = jsonData[0];",
									"        pm.expect(notification).to.have.property('id');",
									"        pm.expect(notification).to.have.property('title');",
									"        pm.expect(notification).to.have.property('message');",
									"        pm.expect(notification).to.have.property('createdAt');",
									"        pm.expect(notification).to.have.property('createdAtFormatted');",
									"        pm.expect(notification).to.have.property('isRead');",
									"        pm.expect(notification).to.have.property('type');",
									"        pm.expect(notification).to.have.property('referenceId');",
									"    }",
									"});",
									"",
									"pm.test(\"Notification type is valid\", function () {",
									"    var jsonData = pm.response.json();",
									"    var validTypes = ['SR_CREATED', 'SR_ASSIGNED', 'SR_COMPLETED', 'SR_CANCELLED', 'TECH_ON_WAY', 'TECH_ARRIVED', 'NEW_SR_AVAILABLE'];",
									"    if (jsonData.length > 0) {",
									"        pm.expect(validTypes).to.include(jsonData[0].type);",
									"    }",
									"});",
									"",
									"pm.test(\"createdAtFormatted is human-readable\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.length > 0) {",
									"        pm.expect(jsonData[0].createdAtFormatted).to.be.a('string');",
									"        pm.expect(jsonData[0].createdAtFormatted.length).to.be.above(0);",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/notifications?unreadOnly=true",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"notifications"
							],
							"query": [
								{
									"key": "unreadOnly",
									"value": "true"
								}
							]
						},
						"description": "Get notifications with all required fields: id, title, message, createdAt, createdAtFormatted, isRead, type, referenceId"
					}
				},
				{
					"name": "Get All Notifications (No Filter)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Returns both read and unread notifications\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.be.an('array');",
									"    if (jsonData.length > 1) {",
									"        var hasRead = jsonData.some(n => n.isRead === true);",
									"        var hasUnread = jsonData.some(n => n.isRead === false);",
									"        pm.expect(hasRead || hasUnread).to.be.true;",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/notifications",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"notifications"
							]
						},
						"description": "Get all notifications without filtering by read status"
					}
				},
				{
					"name": "Mark Notification as Read",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Notification marked as read\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.include('marked as read');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/notifications/1/read",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"notifications",
								"1",
								"read"
							]
						},
						"description": "Mark a specific notification as read"
					}
				},
				{
					"name": "Mark All as Read",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"All notifications marked as read\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.include('All notifications');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/notifications/read-all",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"notifications",
								"read-all"
							]
						},
						"description": "Mark all notifications as read for the authenticated user"
					}
				}
			]
		},
		{
			"name": "Location (GPS)",
			"item": [
				{
					"name": "Update My Location",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"latitude\": 23.8103,\n  \"longitude\": 90.4125,\n  \"status\": \"ONLINE\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/location/update",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"location",
								"update"
							]
						}
					}
				},
				{
					"name": "Get Nearby Technicians",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/location/nearby?latitude=23.8103&longitude=90.4125&radius=5",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"location",
								"nearby"
							],
							"query": [
								{
									"key": "latitude",
									"value": "23.8103"
								},
								{
									"key": "longitude",
									"value": "90.4125"
								},
								{
									"key": "radius",
									"value": "5"
								}
							]
						}
					}
				},
				{
					"name": "Get Technician's Location",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/location/technician/6",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"location",
								"technician",
								"6"
							]
						}
					}
				},
				{
					"name": "Get ETA to Location",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/location/eta?technicianId=6&destinationLat=23.8200&destinationLng=90.4200",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"location",
								"eta"
							],
							"query": [
								{
									"key": "technicianId",
									"value": "6"
								},
								{
									"key": "destinationLat",
									"value": "23.8200"
								},
								{
									"key": "destinationLng",
									"value": "90.4200"
								}
							]
						},
						"description": "Calculate estimated time of arrival for technician to destination"
					}
				},
				{
					"name": "Get Location History",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/location/history/4?startDate=2025-11-01&endDate=2025-11-30",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"location",
								"history",
								"4"
							],
							"query": [
								{
									"key": "startDate",
									"value": "2025-11-01"
								},
								{
									"key": "endDate",
									"value": "2025-11-30"
								}
							]
						},
						"description": "Get technician's location history for a date range (Admin/Dispatcher only)"
					}
				}
			]
		},
		{
			"name": "Call Center",
			"item": [
				{
					"name": "Login - Call Center",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"pm.environment.set(\"callCenterToken\", jsonData.token);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"phone\": \"3333333333\",\n  \"password\": \"callcenter123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						}
					}
				},
				{
					"name": "Create Customer with GPS",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"newCustomerId\", jsonData.user.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{callCenterToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"New Customer\",\n  \"phone\": \"7777777777\",\n  \"password\": \"customer123\",\n  \"homeAddress\": \"123 Main Street, Dhaka\",\n  \"latitude\": -1.286389,\n  \"longitude\": 36.817223\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/callcenter/customers",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"callcenter",
								"customers"
							]
						},
						"description": "Call center creates a new customer with manual GPS coordinates and home address"
					}
				},
				{
					"name": "Get WO Technician Info",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{callCenterToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/callcenter/wos/{{woId}}/technician",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"callcenter",
								"wos",
								"{{woId}}",
								"technician"
							]
						},
						"description": "Get assigned technician info including location, distance, and ETA for a work order"
					}
				}
			]
		},
		{
			"name": "Dispatcher",
			"item": [
				{
					"name": "Get Nearby Technicians for Job",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/dispatcher/technicians/nearby?latitude=-1.286389&longitude=36.817223&maxDistance=50&status=ONLINE",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"dispatcher",
								"technicians",
								"nearby"
							],
							"query": [
								{
									"key": "latitude",
									"value": "-1.286389",
									"description": "Job location latitude"
								},
								{
									"key": "longitude",
									"value": "36.817223",
									"description": "Job location longitude"
								},
								{
									"key": "maxDistance",
									"value": "50",
									"description": "Maximum distance in km (optional)"
								},
								{
									"key": "status",
									"value": "ONLINE",
									"description": "Filter by status (optional)"
								}
							]
						},
						"description": "Get list of technicians sorted by distance from job location with availability status and open jobs count"
					}
				},
				{
					"name": "Get Technician Workload",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/dispatcher/technicians/4/workload",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"dispatcher",
								"technicians",
								"4",
								"workload"
							]
						},
						"description": "Get technician's current workload including all open work orders and summary"
					}
				}
			]
		},
		{
			"name": "Reviews & Ratings",
			"item": [
				{
					"name": "Create Review",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"woId\": \"{{woId}}\",\n  \"rating\": 5,\n  \"comment\": \"Excellent service! Technician was professional and fixed the issue quickly.\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/reviews",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"reviews"
							]
						},
						"description": "Customer creates review for completed work order (rating 1-5)"
					}
				},
				{
					"name": "Get Technician Reviews",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{techToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/reviews/technician/4",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"reviews",
								"technician",
								"4"
							]
						},
						"description": "Get all reviews for a specific technician with average rating"
					}
				},
				{
					"name": "Get Work Order Review",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{customerToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/reviews/wo/{{woId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"reviews",
								"wo",
								"{{woId}}"
							]
						},
						"description": "Get review for a specific work order"
					}
				}
			]
		},
		{
			"name": "Dispatch Center",
			"item": [
				{
					"name": "Get Dispatch Overview",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/dispatch/overview",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"dispatch",
								"overview"
							]
						},
						"description": "Get dispatch center overview with real-time stats"
					}
				},
				{
					"name": "Get Technician Status",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/dispatch/technician-status",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"dispatch",
								"technician-status"
							]
						},
						"description": "Get real-time status summary of all technicians"
					}
				},
				{
					"name": "Get Recent Work Orders",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/dispatch/recent-work-orders",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"dispatch",
								"recent-work-orders"
							]
						},
						"description": "Get recent work orders for dispatch monitoring"
					}
				},
				{
					"name": "Get Technician Locations (Dispatch)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{dispatcherToken}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/dispatch/technician-locations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"dispatch",
								"technician-locations"
							]
						},
						"description": "Get all technician locations for dispatch map view"
					}
				}
			]
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:4000",
			"type": "string"
		},
		{
			"key": "imageUploadServiceUrl",
			"value": "https://img.mtscorporate.com",
			"type": "string"
		},
		{
			"key": "srId",
			"value": "",
			"type": "string"
		},
		{
			"key": "woId",
			"value": "",
			"type": "string"
		},
		{
			"key": "paymentId",
			"value": "",
			"type": "string"
		},
		{
			"key": "payoutRequestId",
			"value": "",
			"type": "string"
		},
		{
			"key": "adminToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "dispatcherToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "techToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "customerToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "callCenterToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "newCustomerId",
			"value": "",
			"type": "string"
		},
		{
			"key": "srNumber",
			"value": "",
			"type": "string"
		},
		{
			"key": "woNumber",
			"value": "",
			"type": "string"
		}
	]
}